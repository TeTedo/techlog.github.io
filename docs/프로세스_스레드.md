# 컴퓨터에서의 프로세스와 스레드 이해하기

컴퓨터에서 여러 프로그램이 동시에 실행될 수 있는 이유는 운영체제가 **프로세스(Process)** 와 **스레드(Thread)** 라는 개념을 도입하고, 이를 기반으로 **멀티프로그래밍**, **멀티태스킹**, **멀티스레딩**, **멀티프로세싱** 등을 조화롭게 운용하기 때문입니다. 이 문서는 이러한 핵심 개념들을 실제 시스템 구조와 함께 설명하고, 관련된 전문 용어도 함께 해설합니다.

## 1. 기본 개념

### 프로그램 (Program)

- 정적인 코드 파일 (예: `.exe`, `.py`)
- 메모리에 올라가기 전 상태

### 프로세스 (Process)

- 실행 중인 프로그램 인스턴스
- 독립된 메모리 공간(코드, 데이터, 힙, 스택)을 가짐
- 다른 프로세스와 메모리 공유

### 스레드 (Thread)

- 프로세스 내부의 실행 단위
- 같은 프로세스 내 다른 스레드들과 **메모리 공유 (코드, 데이터, 힙)**
- **스택만 별도**로 가짐

## 2. 단일 프로세스 시스템의 한계

- 오직 하나의 프로그램만 실행 가능
- 다른 프로그램을 실행하려면 현재 프로그램 종료 필요
- I/O 대기 중 CPU가 놀게 됨 → 비효율

## 3. 멀티프로그래밍 (Multiprogramming)

### 정의

- 여러 개의 프로그램을 메모리에 동시에 올려놓고 운영

### 작동 원리

- 현재 실행 중인 프로세스가 I/O에 진입하면 → CPU는 다른 프로세스로 **전환(Context Switch)**

### 장점

- CPU 유휴 시간 최소화 → 자원 활용 극대화

### 단점

- CPU 점유가 긴 프로세스가 있을 경우 → 다른 프로세스 대기 시간 증가

## 4. 멀티태스킹 (Multitasking)

### 정의

- CPU 시간을 매우 작은 단위(**타임슬라이스**)로 나눠서 여러 프로세스를 **빠르게 교체하며 실행**

### 특징

- 사용자는 동시에 여러 작업이 수행되는 것처럼 체감
- 핵심 기술: **컨텍스트 스위칭(Context Switching)**

### 예시

- 크롬으로 유튜브 보면서
- 디스코드로 채팅하고
- 백그라운드에서 VSCode로 코드 실행
  → 각각은 서로 다른 프로세스입니다.

## 5. 스레드와 멀티스레딩 (Multithreading)

### 스레드의 필요성

- 프로세스 전환은 비용이 큼
- 하나의 프로세스 내에서 병렬 처리하고 싶음

### 스레드의 장점

- 스레드 간 전환은 비용이 적음 (메모리 공유)
- 작업을 세분화 가능

### 멀티스레딩

- 하나의 프로세스가 여러 작업을 동시에 수행
- 예: 게임에서 그래픽 처리, 입력 처리, 사운드 처리를 각각 다른 스레드로 분리
- 유튜브 탭에서:

  - 영상 재생
  - UI 반응 처리
  - 댓글 로딩
  - 자막 렌더링
    → 모두 하나의 프로세스(렌더러 프로세스) 안에서 스레드로 나뉘어 실행

## 6. 멀티프로세싱 (Multiprocessing)

### 정의

- 2개 이상의 CPU 또는 코어를 사용하여 **실제로 동시에 여러 작업 처리**

### 구조

- SMP (Symmetric Multiprocessing): 모든 코어가 자원에 접근 가능
- AMP (Asymmetric): 주 처리 코어와 보조 코어 분리

### 활용 예시

💡 웹 서버 (예: NGINX, Gunicorn)

- 수많은 HTTP 요청을 동시에 처리할 때, 멀티프로세싱을 활용하여 각 요청을 병렬 처리

#### NGINX: 이벤트 기반 + 워커 프로세스 구조

- `worker_processes auto;` 설정 시, CPU 코어 수만큼 워커 프로세스 생성
- 각 워커 프로세스가 독립적으로 클라이언트 요청 처리

#### Gunicorn (Python WSGI 서버)

- Flask, Django 앱을 서비스할 때 여러 개의 워커 프로세스를 띄워 병렬 처리
- `--workers 4` 옵션으로 프로세스 4개 생성

#### Node.js Cluster 모듈

- Node.js는 단일 스레드지만, Cluster로 코어 수만큼 프로세스 분기 가능

---

## 7. 예제 비교 요약표

| 개념           | 설명                                   | 예시                         |
| -------------- | -------------------------------------- | ---------------------------- |
| 단일 프로세스  | 하나의 작업만 실행 가능                | MS-DOS 시대                  |
| 멀티프로그래밍 | 여러 프로세스 메모리에 올림            | 텍스트 편집 중 파일 다운로드 |
| 멀티태스킹     | 타임슬라이스 기반으로 빠르게 교체 실행 | 브라우징 + 음악 재생         |
| 멀티스레딩     | 한 프로세스 내 스레드로 작업 병렬화    | 게임 내 렌더링 + 오디오      |
| 멀티프로세싱   | 여러 CPU 코어로 실제 병렬 처리         | 데이터 분석, AI 연산         |

---

## 8. 프로세스 vs 스레드 비교 요약

| 항목                 | 프로세스                             | 스레드                                       |
| -------------------- | ------------------------------------ | -------------------------------------------- |
| 정의                 | 실행 중인 프로그램 인스턴스          | 프로세스 내부의 실행 단위                    |
| 메모리 구조          | 각 프로세스는 **독립된 메모리 공간** | 스레드는 **프로세스와 메모리 공유**          |
| 생성 비용            | 상대적으로 높음                      | 낮음                                         |
| 컨텍스트 스위칭 비용 | 높음                                 | 낮음                                         |
| 안정성               | 높은 독립성으로 안정성 높음          | 공유 메모리로 인해 하나의 오류가 전체에 영향 |
| 통신 방법            | IPC(파이프, 메시지 큐, 소켓 등)      | 메모리 공유 및 동기화 객체(Mutex 등)         |
| 활용 예              | 웹 서버 워커 프로세스                | 게임 엔진 구성, 대용량 연산 병렬 처리        |

---

## 9. 컨텍스트 스위칭의 비용

- 현재 실행 중인 프로세스나 스레드의 상태(context)를 저장하고, 새로운 작업으로 전환

### 비용 발생 요인

- CPU 레지스터 상태 저장/복원
- 캐시 무효화 (Cache Flush)
- 메모리 매핑 전환 (TLB Flush)
- 커널 ↔ 유저 모드 전환

### 최적화 방법

- 스레드 사용
- 경량 스레드 기반 구조 (예: 고루틴)

## 10. 유저 스레드 vs 커널 스레드

| 항목            | 유저 스레드                   | 커널 스레드                   |
| --------------- | ----------------------------- | ----------------------------- |
| 생성/관리       | 유저 공간에서 직접 관리       | 커널이 직접 관리              |
| 컨텍스트 스위칭 | 빠름                          | 느림 (시스템 콜 필요)         |
| 병렬성          | 단일 코어에서만 실행 가능     | 멀티코어 실행 가능            |
| 예시            | Python `threading` 모듈 (GIL) | Java native thread, Go 고루틴 |

## 11. 병행성과 병렬성 (Concurrency vs Parallelism)

| 항목      | 병행성 (Concurrency)                                | 병렬성 (Parallelism)             |
| --------- | --------------------------------------------------- | -------------------------------- |
| 정의      | 여러 작업을 빠르게 전환하며 실행                    | 여러 작업을 실제로 동시에 실행   |
| 예시      | 싱글코어에서 여러 작업을 전환하며 처리 (멀티태스킹) | 멀티코어에서 각각 다른 작업 처리 |
| 대표 기술 | 멀티스레딩, 논블로킹 I/O                            | 멀티프로세싱, 분산 컴퓨팅        |
| 언어 특징 | JavaScript (싱글스레드, 병행성 지향)                | C/C++ 병렬 연산, CUDA 병렬 처리  |

## 13. 현대 OS에서의 활용 사례

| 시스템      | 특징                                                         |
| ----------- | ------------------------------------------------------------ |
| **리눅스**  | `fork()`, `pthread`, `clone()` 기반 멀티프로세싱/스레딩 제공 |
| **윈도우**  | `CreateProcess`, `CreateThread`, IOCP 등 고성능 처리 지원    |
| **macOS**   | GCD (Grand Central Dispatch) 기반 멀티코어 스케줄링          |
| **Node.js** | 싱글 스레드 기반 + Cluster/worker_threads로 확장 가능        |
| **Go 언어** | 고루틴 기반 M\:N 경량 스레드 구조 → 동시성 최적화            |

## 용어 해설

| 용어                                    | 설명                                                                                                |
| --------------------------------------- | --------------------------------------------------------------------------------------------------- |
| **프로세스 (Process)**                  | 메모리에 올라가 실행 중인 프로그램 인스턴스. 독립된 메모리 공간 사용                                |
| **스레드 (Thread)**                     | 프로세스 내의 실행 단위. 다른 스레드와 메모리 공유 (단, 스택은 별도)                                |
| **멀티프로그래밍 (Multiprogramming)**   | 여러 프로그램을 동시에 메모리에 올려놓고 실행 순서를 바꿔가며 실행                                  |
| **멀티태스킹 (Multitasking)**           | CPU 시간을 짧게 나눠 여러 작업을 교차로 빠르게 실행. 사용자는 동시에 실행되는 것처럼 느낌           |
| **멀티스레딩 (Multithreading)**         | 하나의 프로세스 내에서 여러 작업을 병렬로 실행하기 위한 구조                                        |
| **멀티프로세싱 (Multiprocessing)**      | 여러 개의 CPU 또는 코어를 사용하는 병렬 처리 방식                                                   |
| **컨텍스트 스위칭 (Context Switching)** | CPU가 실행 중인 작업(프로세스 또는 스레드)을 바꾸기 위해 레지스터, 상태 등을 저장하고 복원하는 작업 |
| **타임슬라이스 (Time Slice)**           | CPU가 각 프로세스/스레드에게 할당하는 짧은 실행 시간 단위                                           |
| **SMP (Symmetric Multiprocessing)**     | 모든 프로세서가 동일하게 메모리/자원에 접근할 수 있는 구조                                          |
| **AMP (Asymmetric Multiprocessing)**    | 특정 프로세서만 메모리/자원에 접근하며, 나머지는 보조 역할                                          |
